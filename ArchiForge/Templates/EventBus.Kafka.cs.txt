using Confluent.Kafka;
using System.Threading.Tasks;

namespace {{ProjectName}}.Infrastructure.EventBus
{
    public class KafkaProducer
    {
        private readonly IProducer<Null, string> _producer;
        public KafkaProducer(string bootstrapServers) { _producer = new ProducerBuilder<Null, string>(new ProducerConfig { BootstrapServers = bootstrapServers }).Build(); }
        public Task Publish(string topic, string message) { return _producer.ProduceAsync(topic, new Message<Null, string> { Value = message }); }
    }
}
